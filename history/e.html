<!DOCTYPE html>
<html lang="zh-Hant">
  <head>
    <meta charset="utf-8">
    <title></title>
  </head>
  <body>

    <h1>E 網頁</h1>
    <script>
      // document.referrer 可取得是哪個網址連過來。
      // 但從 https 網站 連到 http 網站，以下這行會印出空字串，因為 http 網站較不安全。
      console.log("referrer: " + document.referrer);
      
      // 判斷是從外部網站進來自己網站
      if( !(document.referrer).includes(location.host) ){
        alert("從外站進來這頁");

        // 將目前網址先暫存(e.html)
        var current_url = location.href; // e.html

        // 將目前瀏覽歷程的 url 設定為 a.html // referrer → a.html → e.html
        history.replaceState(null, null, "a.html");

        // 新增一個瀏覽歷程，為 current_url
        history.pushState(null, null, current_url);

        // 按上一頁時，觸發 popstate 事件
        window.addEventListener("popstate", function(e){
          //alert("觸發 popstate 事件");
          console.log("123");
          location.reload();
        });

      }
    </script>
  </body>
</html>
